<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Checkout</title>
</head>
<body>
    <nav>
        <a href="{{ url_for('index') }}">Home</a>
        <a href="{{ url_for('products') }}">Products</a>
        <a href="{{ url_for('checkout') }}">Cart</a>
        {% if session.get('user') %}
            <a href="{{ url_for('logout') }}">Sign Out</a>
        {% else %}
            <a href="{{ url_for('login') }}">Login</a>
            <a href="{{ url_for('register') }}">Register</a>
        {% endif %}
    </nav>
    <h1>Checkout</h1>
    <h2>Cart</h2>
    <ul>
        {% for item in cart %}
        <li>
            <h3>{{ item.product_name }}</h3>
            <p>Price: ${{ item.product_price }}</p>
            <form action="{{ url_for('remove_from_cart', product_id=item.product_id) }}" method="post">
                <button type="submit">Remove</button>
            </form>
        </li>
        {% endfor %}
    </ul>
    <h3>Total Price: ${{ total_price }}</h3>

    <h2>Negotiate Price</h2>
    <form method="post">
        <input type="hidden" name="action" value="negotiate">
        <input type="text" name="negotiate_input" placeholder="Enter your negotiation">
        <button type="submit">Negotiate</button>
    </form>

    <h2>Chat Log</h2>
    <div>
        {% for log in chat_log %}
        <p><strong>User:</strong> {{ log.user }}</p>
        <p><strong>Bot:</strong> {{ log.bot }}</p>
        {% endfor %}
    </div>

    <h2>Complete Purchase</h2>
    <form method="post">
        <input type="hidden" name="action" value="purchase">
        <button type="submit">Purchase</button>
    </form>
</body>
</html>
